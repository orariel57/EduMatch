<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title>EduMatch | ×”×–×× ×ª ×©×™×¢×•×¨</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- ===== Header â€“ ×–×”×” ×œ×©××¨ ×”×¢××•×“×™× ===== -->
    <header>
        <div class="top-bar">
            <a href="index.html">
                <img src="./image/logoEduMatch.png" alt="EduMatch" class="logo-img">
            </a>

            <nav>
                <ul class="main-nav">
                    <li><a href="index.html">×“×£ ×”×‘×™×ª</a></li>
                    <li><a href="teachers.html">×—×™×¤×•×© ××•×¨×™×</a></li>
                    <li><a href="profile.html">×”×¤×¨×•×¤×™×œ ×©×œ×™</a></li>
                </ul>

                <ul class="auth-nav">
                    <li><a href="login.html">×”×ª×—×‘×¨×•×ª/×”×¨×©××”</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>

        <!-- ×›×•×ª×¨×ª ×¢××•×“ -->
        <section class="page-header">
            <h1>×”×–×× ×ª ×©×™×¢×•×¨</h1>
            <p>×‘×—×¨×™ ×ª××¨×™×š ×•×©×¢×” ×¤× ×•×™×™× ××¦×œ ×”××•×¨×”, ×•××©×¨×™ ××ª ×”×”×–×× ×”.</p>
        </section>

        <!-- ===== ×¤×¨×™×¡×ª ×”×¢××•×“: ×›×¨×˜×™×¡ ××•×¨×” + ×™×•××Ÿ + ×©×¢×•×ª + ×¡×™×›×•× ===== -->
        <section class="booking-layout">

            <!-- ×›×¨×˜×™×¡ ××•×¨×” ××§×•×¦×¨ -->
            <section class="booking-card booking-teacher-card" aria-labelledby="teacher-card-title">
                <h2 id="teacher-card-title">×¤×¨×˜×™ ×”××•×¨×”</h2>

                <div class="booking-teacher-header">
                    <div>
                        <h3 class="booking-teacher-name">×¨×Ÿ ×œ×•×™</h3>
                        <div class="booking-teacher-meta-line">
                            <span class="booking-teacher-subject">××ª××˜×™×§×”</span>
                            <span class="booking-separator">â€¢</span>
                            <span class="booking-teacher-city">×ª×œ ××‘×™×‘</span>
                        </div>
                    </div>
                </div>

                <div class="booking-teacher-extra">
                    <div class="booking-lesson-modes">
                        <span class="lesson-mode-tag" data-mode="online">ğŸ’» ××§×•×•×Ÿ</span>
                        <span class="lesson-mode-tag" data-mode="in-person">ğŸ« ×¤×¨×•× ×˜×œ×™</span>
                    </div>

                    <p class="booking-teacher-price">
                        ××—×™×¨ ×œ×©×™×¢×•×¨: <strong>120 ×©"×—</strong> / <span id="lesson-duration-label">60 ×“×§×•×ª</span>
                    </p>
                </div>
            </section>

            <!-- ×¦×“ ×©×××œ: ×™×•××Ÿ + ×©×¢×•×ª + ×¡×™×›×•× -->
            <div class="booking-main-columns">

                <!-- ×™×•××Ÿ ×ª××¨×™×›×™× -->
                <section class="booking-card booking-calendar-card" aria-labelledby="calendar-title">
                    <h2 id="calendar-title">×‘×—×¨×™ ×ª××¨×™×š</h2>

                    <div class="calendar-header">
                        <button type="button" class="calendar-nav-btn" id="prev-month" aria-label="×—×•×“×© ×§×•×“×">
                            â€¹
                        </button>

                        <div class="calendar-current-month">
                            <span id="calendar-month-label"></span>
                        </div>

                        <button type="button" class="calendar-nav-btn" id="next-month" aria-label="×—×•×“×© ×”×‘×">
                            â€º
                        </button>
                    </div>

                    <!-- ×©××•×ª ×”×™××™× -->
                    <div class="calendar-grid calendar-grid-names">
                        <div class="calendar-day-name">×'</div>
                        <div class="calendar-day-name">×‘'</div>
                        <div class="calendar-day-name">×’'</div>
                        <div class="calendar-day-name">×“'</div>
                        <div class="calendar-day-name">×”'</div>
                        <div class="calendar-day-name">×•'</div>
                        <div class="calendar-day-name">×©'</div>
                    </div>

                    <!-- ×”×™××™× ×¢×¦×× × ×‘× ×™× ×‘-JS -->
                    <div id="calendar-days" class="calendar-grid calendar-grid-days"></div>
                </section>

                <!-- ×¨×©×™××ª ×©×¢×•×ª ×–××™× ×•×ª -->
                <section class="booking-card booking-times-card" aria-labelledby="times-title">
                    <h2 id="times-title">×‘×—×¨×™ ×©×¢×”</h2>
                    <p class="booking-times-hint">×‘×—×¨×™ ×§×•×“× ×ª××¨×™×š ×‘×™×•××Ÿ ×›×“×™ ×œ×¨××•×ª ×©×¢×•×ª ×–××™× ×•×ª.</p>

                    <div id="time-slots" class="time-slots">
                        <!-- × ×‘× ×” ×‘-JS ×œ×¤×™ ×”×™×•× ×©× ×‘×—×¨ -->
                    </div>
                </section>

                <!-- ×¡×™×›×•× ×”×–×× ×” -->
                <section class="booking-card booking-summary-card" aria-labelledby="summary-title">
                    <h2 id="summary-title">×¡×™×›×•× ×”×–×× ×”</h2>

                    <div class="booking-summary-row">
                        <span class="summary-label">×ª××¨×™×š × ×‘×—×¨:</span>
                        <span class="summary-value" id="summary-date">×œ× × ×‘×—×¨</span>
                    </div>

                    <div class="booking-summary-row">
                        <span class="summary-label">×©×¢×” × ×‘×—×¨×ª:</span>
                        <span class="summary-value" id="summary-time">×œ× × ×‘×—×¨</span>
                    </div>

                    <div class="booking-summary-row">
                        <span class="summary-label">××•×¤×Ÿ ×”×©×™×¢×•×¨:</span>
                        <div class="summary-value">
                            <!-- ×©× ×™×”× × ×ª××›×™× ××¦×œ ×”××•×¨×” â€“ ×‘×—×™×¨×” ×‘×™× ×™×”× -->
                            <label class="summary-radio">
                                <input type="radio" name="summary-lesson-mode" value="online" checked>
                                ××§×•×•×Ÿ
                            </label>
                            <label class="summary-radio">
                                <input type="radio" name="summary-lesson-mode" value="in-person">
                                ×¤×¨×•× ×˜×œ×™
                            </label>
                        </div>
                    </div>

                    <div class="booking-summary-row">
                        <span class="summary-label">××©×š ×©×™×¢×•×¨:</span>
                        <span class="summary-value" id="summary-duration">60 ×“×§×•×ª</span>
                    </div>

                    <div class="booking-summary-row">
                        <span class="summary-label">××—×™×¨ ×”×©×™×¢×•×¨:</span>
                        <span class="summary-value" id="summary-price">120 ×©"×—</span>
                    </div>

                    <div class="booking-summary-actions">
                        <button type="button" class="btn-primary" id="confirm-booking" disabled>
                            ××™×©×•×¨ ×”×–×× ×”
                        </button>
                        <a href="teachers.html" class="btn-secondary">
                            ×‘×™×˜×•×œ
                        </a>
                    </div>
                </section>

            </div>
        </section>
    </main>

    <!-- ===== FOOTER â€“ ×–×”×” ×œ×©××¨ ×”×¢××•×“×™× ===== -->
    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="privacy.html">××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª</a>
                <a href="terms.html">×ª× ××™ ×©×™××•×©</a>
                <p>Â© 2025 EduMatch ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.</p>
            </div>
        </div>
    </footer>

    <!-- ===== JS ×œ×¢××•×“ ×”×”×–×× ×” ===== -->
    <script>
        // ×¡×™××•×œ×¦×™×”: ×”×× ×”××©×ª××© ××—×•×‘×¨
        // ××¤×©×¨ ×œ×”×—×œ×™×£ ×œ-true ×›×“×™ ×œ×‘×“×•×§ ××ª ×–×¨×™××ª "×”×‘×§×©×” × ×©×œ×—×”..."
        const isUserLoggedIn = false;

        // × ×ª×•× ×™ ×”××•×¨×” ×œ×“×•×’××” (×™×›×•×œ×™× ×œ×”×™×•×ª ×“×™× ××™×™× ×‘×¢×ª×™×“)
        const lessonDurationMinutes = 60;
        const lessonPriceShekels = 120;

        // ×–×× ×™ ×©×™×¢×•×¨ ×œ×“×•×’××” â€“ × ×˜×¢× ×™× ×œ×›×œ ×ª××¨×™×š ×–××™×Ÿ
        const baseTimeSlots = ["16:00", "17:00", "18:30", "20:00"];

        let currentYear, currentMonth;   // ×”×—×•×“×© ×©××•×¦×’ ×‘×™×•××Ÿ
        let selectedDate = null;
        let selectedTime = null;

        const monthNamesHebrew = [
            "×™× ×•××¨", "×¤×‘×¨×•××¨", "××¨×¥", "××¤×¨×™×œ", "×××™", "×™×•× ×™",
            "×™×•×œ×™", "××•×’×•×¡×˜", "×¡×¤×˜××‘×¨", "××•×§×˜×•×‘×¨", "× ×•×‘××‘×¨", "×“×¦××‘×¨"
        ];

        const calendarMonthLabel = document.getElementById("calendar-month-label");
        const calendarDaysContainer = document.getElementById("calendar-days");
        const timeSlotsContainer = document.getElementById("time-slots");

        const summaryDateEl = document.getElementById("summary-date");
        const summaryTimeEl = document.getElementById("summary-time");
        const summaryDurationEl = document.getElementById("summary-duration");
        const summaryPriceEl = document.getElementById("summary-price");
        const confirmBtn = document.getElementById("confirm-booking");

        // ===== ××ª×—×•×œ ×¨××©×•× ×™ ×©×œ ×”×™×•××Ÿ =====
        (function initCalendar() {
            const today = new Date();
            currentYear = today.getFullYear();
            currentMonth = today.getMonth();

            summaryDurationEl.textContent = lessonDurationMinutes + " ×“×§×•×ª";
            summaryPriceEl.textContent = lessonPriceShekels + " ×©\"×—";

            renderCalendar(currentYear, currentMonth);

            document.getElementById("prev-month").addEventListener("click", () => {
                changeMonth(-1);
            });

            document.getElementById("next-month").addEventListener("click", () => {
                changeMonth(1);
            });
        })();

        function changeMonth(offset) {
            currentMonth += offset;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }

            selectedDate = null;
            selectedTime = null;
            updateSummary();
            updateConfirmButtonState();
            timeSlotsContainer.innerHTML = "";
            document.querySelector(".booking-times-hint").textContent =
                "×‘×—×¨×™ ×§×•×“× ×ª××¨×™×š ×‘×™×•××Ÿ ×›×“×™ ×œ×¨××•×ª ×©×¢×•×ª ×–××™× ×•×ª.";

            renderCalendar(currentYear, currentMonth);
        }

        function renderCalendar(year, month) {
            calendarDaysContainer.innerHTML = "";

            const firstDayOfMonth = new Date(year, month, 1);
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const startDayIndex = firstDayOfMonth.getDay(); // 0=×', 6=×©'

            calendarMonthLabel.textContent = monthNamesHebrew[month] + " " + year;

            // ×¨×•×•×—×™× ×œ×¤× ×™ ×”×™×•× ×”×¨××©×•×Ÿ
            for (let i = 0; i < startDayIndex; i++) {
                const blankCell = document.createElement("div");
                blankCell.className = "calendar-day calendar-day--empty";
                calendarDaysContainer.appendChild(blankCell);
            }

            const today = new Date();
            const isSameMonthAsToday = (year === today.getFullYear() && month === today.getMonth());

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dayOfWeek = date.getDay(); // 0=×',...,6=×©'

                const dayCell = document.createElement("button");
                dayCell.type = "button";
                dayCell.classList.add("calendar-day");
                dayCell.textContent = day;

                // ×”×™×•×
                if (isSameMonthAsToday && day === today.getDate()) {
                    dayCell.classList.add("calendar-day--today");
                }

                // ×™××™× ×œ× ×–××™× ×™× â€“ ×œ×“×•×’××”: ×©×™×©×™-×©×‘×ª (5,6)
                const isDisabled = (dayOfWeek === 5 || dayOfWeek === 6);
                if (isDisabled) {
                    dayCell.classList.add("calendar-day--disabled");
                    dayCell.disabled = true;
                } else {
                    // ×™×•× ×–××™×Ÿ â€“ ××¤×©×¨ ×œ×‘×—×•×¨
                    dayCell.addEventListener("click", () => onDateSelected(year, month, day));
                }

                // ×× ×–×” ×”×™×•× ×©× ×‘×—×¨
                if (selectedDate &&
                    selectedDate.getFullYear() === year &&
                    selectedDate.getMonth() === month &&
                    selectedDate.getDate() === day) {
                    dayCell.classList.add("calendar-day--selected");
                }

                calendarDaysContainer.appendChild(dayCell);
            }
        }

        function onDateSelected(year, month, day) {
            selectedDate = new Date(year, month, day);
            selectedTime = null;

            // ×”×¡×¨×ª ×‘×—×™×¨×” ×§×•×“××ª
            document.querySelectorAll(".calendar-day--selected").forEach(el => {
                el.classList.remove("calendar-day--selected");
            });

            // ×¡×™××•×Ÿ ×”×™×•× ×”× ×‘×—×¨
            const dayCells = calendarDaysContainer.querySelectorAll(".calendar-day");
            dayCells.forEach(cell => {
                if (cell.textContent === String(day) && !cell.classList.contains("calendar-day--disabled")) {
                    cell.classList.add("calendar-day--selected");
                }
            });

            // ×¢×“×›×•×Ÿ ×¡×™×›×•×
            const displayDate = `${day} ${monthNamesHebrew[month]} ${year}`;
            summaryDateEl.textContent = displayDate;
            summaryTimeEl.textContent = "×œ× × ×‘×—×¨";

            // ×˜×¢×™× ×ª ×”×©×¢×•×ª ×œ××•×ª×• ×™×•×
            loadTimeSlotsForDate(selectedDate);

            updateConfirmButtonState();
        }

        function loadTimeSlotsForDate(date) {
            timeSlotsContainer.innerHTML = "";
            document.querySelector(".booking-times-hint").textContent =
                "×‘×—×¨×™ ×©×¢×” ×–××™× ×” ××ª×•×š ×”×¨×©×™××”.";

            // ×›××Ÿ ××¤×©×¨ ×‘×¢×ª×™×“ ×œ×‘×“×•×§ ×–××™× ×•×ª ×¡×¤×¦×™×¤×™×ª ×œ×¤×™ ×ª××¨×™×š.
            baseTimeSlots.forEach(timeStr => {
                const btn = document.createElement("button");
                btn.type = "button";
                btn.className = "time-slot";
                btn.textContent = timeStr;

                btn.addEventListener("click", () => onTimeSelected(timeStr));
                timeSlotsContainer.appendChild(btn);
            });
        }

        function onTimeSelected(timeStr) {
            selectedTime = timeStr;

            document.querySelectorAll(".time-slot--selected").forEach(el => {
                el.classList.remove("time-slot--selected");
            });

            document.querySelectorAll(".time-slot").forEach(el => {
                if (el.textContent === timeStr) {
                    el.classList.add("time-slot--selected");
                }
            });

            summaryTimeEl.textContent = timeStr;
            updateConfirmButtonState();
        }

        function updateSummary() {
            if (!selectedDate) {
                summaryDateEl.textContent = "×œ× × ×‘×—×¨";
            }
            if (!selectedTime) {
                summaryTimeEl.textContent = "×œ× × ×‘×—×¨";
            }
        }

        function updateConfirmButtonState() {
            confirmBtn.disabled = !(selectedDate && selectedTime);
        }

        // ===== ×œ×—×™×¦×” ×¢×œ "××™×©×•×¨ ×”×–×× ×”" =====
        confirmBtn.addEventListener("click", () => {
            if (!selectedDate || !selectedTime) {
                return;
            }

            if (!isUserLoggedIn) {
                alert("×™×© ×œ×”×ª×—×‘×¨ ×›×“×™ ×œ×”×–××™×Ÿ ×©×™×¢×•×¨.\n× ×¢×‘×™×¨ ××•×ª×š ×œ×¢××•×“ ×”×”×ª×—×‘×¨×•×ª.");
                window.location.href = "login.html";
                return;
            }

            alert("×”×‘×§×©×” × ×©×œ×—×”. × ×¢×“×›×Ÿ ×œ××—×¨ ××™×©×•×¨ ×”××•×¨×”.");
            // ×›××Ÿ ×‘×¢×ª×™×“ ××¤×©×¨ ×œ×”×¤× ×•×ª ×œ×¢××•×“ '×”×¤×¨×•×¤×™×œ ×©×œ×™' ××• '×”×©×™×¢×•×¨×™× ×©×œ×™'
        });
    </script>
    <script src="js/storage.js"></script>
<script src="js/auth.js"></script>
<script src="js/book.js"></script>


</body>

</html>